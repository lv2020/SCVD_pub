{"filename": "packages/protocol/contracts/AccountRegistry/epochs/20200106/Behaviour20200106.sol", "patch": "@@ -1,6 +1,5 @@\n pragma solidity >=0.5.0 <0.6.0;\n \n-import \"@openzeppelin/contracts-ethereum-package/contracts/GSN/GSNRecipient.sol\";\n import \"@openzeppelin/contracts-ethereum-package/contracts/GSN/Context.sol\";\n import \"@openzeppelin/upgrades/contracts/Initializable.sol\";\n import \"../../../interfaces/IZkAsset.sol\";\n@@ -114,6 +113,7 @@ contract Behaviour20200106 is GSNRecipientTimestampSignature, IAZTEC, LibEIP712\n             hashAZTECAccount(AZTECAccount(_account, _linkedPublicKey)),\n             _signature\n         );\n+        require(_account == address(uint160(uint256(keccak256(_spendingPublicKey)))), 'address does not match public key');\n         require(_account == signer, 'signer must be the account');\n         accountMapping[_account] = _linkedPublicKey;\n         userToAZTECAccountMapping[_account] = _AZTECaddress;", "project_link": "https://github.com/AztecProtocol/AZTEC/commit/24f45481c94df340dcd7100bdd30b6d8a8b770cd", "solc_version": "0.4.18", "packages": "", "bug_version": {"raw_code": "", "flattened_code": "", "commit_id": "617069415fd6117472bec6024f2837b37f22039d"}, "fixed_version": {"raw_code": "", "flattened_code": "", "commit_id": "24f45481c94df340dcd7100bdd30b6d8a8b770cd"}}