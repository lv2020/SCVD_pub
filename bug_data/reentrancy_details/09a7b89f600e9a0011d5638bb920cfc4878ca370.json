{"filename": "blockchain/contracts/Lottery.sol", "patch": "@@ -122,10 +122,10 @@ contract Lottery is\n         uint8 _winnerPercentage,\n         uint256 _lotteryDuration\n     ) external override ifNotStarted onlyOwner {\n+        lotteryStatus = Status.OPEN;\n         costPerTicket = _ticketPrice;\n         winnerPercentage = _winnerPercentage;\n         lotteryDuration = _lotteryDuration;\n-        lotteryStatus = Status.OPEN;\n         startingTimestamp = block.timestamp;\n         emit OpenedLottery(lotteryID);\n     }\n@@ -155,8 +155,10 @@ contract Lottery is\n         onlyWinnerOrOwner\n     {\n         _addLottery();\n-        _transferPrize();\n+        uint256 winnerPrize_ = (prizePool * winnerPercentage) / 100;\n+        address winner_ = winner;\n         _reset();\n+        _transferPrize(winner_, winnerPrize_);\n         emit ClaimedReward(lotteryID);\n     }\n \n@@ -171,10 +173,10 @@ contract Lottery is\n         internal\n         override\n     {\n+        lotteryStatus = Status.COMPLETED;\n         randomWords = _randomWords;\n         randomResult = randomWords[0];\n         winner = participants[randomResult % participants.length];\n-        lotteryStatus = Status.COMPLETED;\n         emit CompletedLottery(lotteryID);\n     }\n \n@@ -188,9 +190,8 @@ contract Lottery is\n         );\n     }\n \n-    function _transferPrize() private {\n-        uint256 winnerPrize = (prizePool * winnerPercentage) / 100;\n-        (bool sent, ) = winner.call{value: winnerPrize}(\"\");\n+    function _transferPrize(address _winner, uint256 _winnerPrize) private {\n+        (bool sent, ) = _winner.call{value: _winnerPrize}(\"\");\n         require(sent, \"Failed to send winner prize!\");\n     }\n \n@@ -207,10 +208,10 @@ contract Lottery is\n     }\n \n     function _reset() private {\n+        lotteryStatus = Status.NOT_STARTED;\n         closingTimestamp = 0;\n         costPerTicket = 0;\n         lotteryDuration = 0;\n-        lotteryStatus = Status.NOT_STARTED;\n         participants = new address payable[](0);\n         prizePool = 0;\n         randomResult = 0;", "project_link": "https://github.com/parsaakbari1209/lottery/commit/a7f995db04a45b727cfa31922b55b0d5fdcc766b", "solc_version": "0.8.0", "packages": "", "bug_version": {"raw_code": "", "flattened_code": "", "commit_id": "09a7b89f600e9a0011d5638bb920cfc4878ca370"}, "fixed_version": {"raw_code": "", "flattened_code": "", "commit_id": "a7f995db04a45b727cfa31922b55b0d5fdcc766b"}}