{"filename": "contracts/RToken.sol", "patch": "@@ -691,12 +691,13 @@ contract RToken is RTokenInterface, Exponential, TokenErrorReporter {\n          *  On success, the rToken has redeemAmount less of cash.\n          *  doTransferOut reverts if anything goes wrong, since we can't be sure if side effects occurred.\n          */\n-        doTransferOut(redeemer, vars.redeemAmount);\n \n         /* We write previously calculated values into storage */\n         totalSupply = vars.totalSupplyNew;\n         accountTokens[redeemer] = vars.accountTokensNew;\n \n+        doTransferOut(redeemer, vars.redeemAmount);\n+\n         /* We emit a Transfer event, and a Redeem event */\n         emit Transfer(redeemer, address(this), vars.redeemTokens);\n         emit Redeem(redeemer, vars.redeemAmount, vars.redeemTokens);\n@@ -783,13 +784,14 @@ contract RToken is RTokenInterface, Exponential, TokenErrorReporter {\n          *  On success, the rToken borrowAmount less of cash.\n          *  doTransferOut reverts if anything goes wrong, since we can't be sure if side effects occurred.\n          */\n-        doTransferOut(borrower, borrowAmount);\n \n         /* We write the previously calculated values into storage */\n         accountBorrows[borrower].principal = vars.accountBorrowsNew;\n         accountBorrows[borrower].interestIndex = borrowIndex;\n         totalBorrows = vars.totalBorrowsNew;\n \n+        doTransferOut(borrower, borrowAmount);\n+\n         /* We emit a Borrow event */\n         emit Borrow(borrower, borrowAmount, vars.accountBorrowsNew, vars.totalBorrowsNew);\n ", "project_link": "https://github.com/rikkei-finance/rifi-protocol/commit/eb4884e34a1cf22a7ea745d4836af7777006e3fa", "bug_version": {"raw_code": "", "flattened_code": "", "commit_id": "0b2096b5ff874dd3b722aaa3182c5dc974ff36fe"}, "fixed_version": {"raw_code": "", "flattened_code": "", "commit_id": "eb4884e34a1cf22a7ea745d4836af7777006e3fa"}}