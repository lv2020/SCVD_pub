{"filename": "ethereum/WebaverseERC721Proxy.sol", "patch": "@@ -37,23 +37,25 @@ contract WebaverseERC721Proxy /* is IERC721Receiver */ {\n         require(!usedWithdrawHashes[prefixedHash], \"hash already used\");\n         usedWithdrawHashes[prefixedHash] = true;\n \n-        if (!deposits[tokenId]) {\n+        bool oldDeposits = deposits[tokenId];\n+\n+        deposits[tokenId] = false;\n+\n+        emit Withdrew(to, tokenId, timestamp);\n+\n+        if (!oldDeposits) {\n             parent.mintTokenId(contractAddress, tokenId, hash, filename);\n-            deposits[tokenId] = true;\n         }\n \n         parent.transferFrom(contractAddress, to, tokenId);\n-        deposits[tokenId] = false;\n-        \n-        emit Withdrew(to, tokenId, timestamp);\n     }\n     function deposit(address to, uint256 tokenId) public {\n-        address from = msg.sender;\n-        address contractAddress = address(this);\n-        parent.transferFrom(from, contractAddress, tokenId);\n-\n         deposits[tokenId] = true;\n \n         emit Deposited(to, tokenId);\n+\n+        address from = msg.sender;\n+        address contractAddress = address(this);\n+        parent.transferFrom(from, contractAddress, tokenId);\n     }\n }", "project_link": "https://github.com/webaverse/contracts/commit/e95dc7068698199ce91a94b2477ab19eb438af34", "solc_version": "0.8.0", "packages": "", "bug_version": {"raw_code": "", "flattened_code": "", "commit_id": "112e14ce873558e18fd0c4404f71bc1373b18ae5"}, "fixed_version": {"raw_code": "", "flattened_code": "", "commit_id": "e95dc7068698199ce91a94b2477ab19eb438af34"}}